<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>mantel.test. mantel 0.2</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">mantel 0.2</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Perform a Mantel test.</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>mantel.test(m1, m2, maxtrials&nbsp;=&nbsp;1000, conflate&nbsp;=&nbsp;FALSE, ks.level&nbsp;=&nbsp;0.05, shuffle&nbsp;=&nbsp;shuffle.locations)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>m1</dt>
      <dd>a (meaning) distance matrix, or list of matrices</dd>
      <dt>m2</dt>
      <dd>a (string) distance matrix, or list of matrices</dd>
      <dt>maxtrials</dt>
      <dd>maximum number of permutations to be tested</dd>
      <dt>conflate</dt>
      <dd>if <code>TRUE</code>, entries with 0 distance in <code>m1</code> will be
conflated by averaging over the corresponding entries in <code>m2</code></dd>
      <dt>ks.level</dt>
      <dd>p-level below which a failure to pass</dd>
      <dt>shuffle</dt>
      <dd>a function applied to <code>m2</code> to shuffle entries, taking a
matrix and an optional permutation specification as its arguments - you
shouldn't normally have to change this</dd>
    </dl>
    
    <div class="Perform a Mantel test.">
      <h2>Perform a Mantel test.</h2>
      
    </div>

    <div class="Value">
      <h2>Value</h2>
      
      <p>a dataframe specifying the results of the Mantel test(s)</p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>
      
      <p>Performs a Mantel permutation test on two distance matrices.</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>
      
      <p>Given two distance matrices (or list of distance matrices) <code>m1</code> and
<code>m2</code>, performs a Mantel permutation test on the two matrices (or all
pairwise combinations of matrices if at least one of the parameters is a
list of matrices), and returns the outcome of the test(s) in a data frame.</p>
  
      <p>The distance matrices can either be of type <a href='http://www.inside-r.org/packages/cran/stats/docs/dist'>dist</a>, plain R
matrices or any object that can be interpreted by <a href='check.dist.html'>check.dist</a>.</p>
  
      <p>If the number of possible permutations is reasonably close to
<code>maxtrials</code>, a deterministic enumeration of all the permutations will
be carried out instead of random sampling.</p>
  
      <p>A warning will be produced if the randomly sampled <code>r</code> coefficients are
not normally distributed according to a Kolmogorov-Smirnoff test, at the
level specified by <code>ks.level</code>). Being normally distributed is a
condition for the calculation of a meaningful z score. Failing the test of
normality will also be signalled by <code>p.smoothed</code> being set to <code>NA</code>.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'># small distance matrix, Mantel test run deterministically
mantel.test(dist(1:4), dist(1:4))
</div>
<strong class='message'>Permutation space is small, enumerating all 24 possible permutations.</strong>
<strong class='warning'>Warning message:
The sample of randomised r&#39;s is not normally distributed, use that z score with a grain of salt</strong>
<div class='output'>  veridical        mean        sd        z p.value p.smoothed sample.size
1         1 -4.6248e-18 0.4568322 2.188988    0.12         NA          24
       msample
1 1, 0.4, ....
</div>
<div class='input'># smallest distance matrix using random permutations (with maxtrials=1000)
mantel.test(dist(1:7), dist(1:7))
</div>
<strong class='warning'>Warning message:
The sample of randomised r&#39;s is not normally distributed, use that z score with a grain of salt</strong>
<div class='output'>  veridical        mean        sd        z     p.value p.smoothed sample.size
1         1 0.006785714 0.2248117 4.417983 0.000999001         NA        1000
       msample
1 -0.13571....
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>mantel.test</li>
    </ul>
    <ul>
      
    </ul> -->
      
    <h2>See also</h2>
    
<code>|link{cor}</code>, <code><a href='hammingdists.html'>hammingdists</a></code>,
  <code><a href='normalisedlevenshteindists.html'>normalisedlevenshteindists</a></code>

        
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>