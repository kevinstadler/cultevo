<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform a Mantel permutation test. — mantel.test • cultevo</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">cultevo</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kevinstadler/cultevo">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform a Mantel permutation test.</h1>
    </div>

    
    <p>Perform a correlation test between two matrices. The Mantel test is
different from classical correlation tests (such as
<code><a href='http://www.rdocumentation.org/packages/stats/topics/cor.test'>cor.test</a></code>) in that the null distribution of the
correlation coefficient is determined empirically by shuffling the locations
in one of the matrices and calculating the resulting correlations to
generate an empirical null distribution for the given data set.</p>
    

    <pre><span class='fu'>mantel.test</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>mantel.test</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>,
  <span class='kw'>trials</span> <span class='kw'>=</span> <span class='fl'>5000</span>, <span class='kw'>shuffle</span> <span class='kw'>=</span> <span class='no'>shuffle.locations</span>, <span class='no'>...</span>)

<span class='co'># S3 method for formula</span>
<span class='fu'>mantel.test</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>stringdistfun</span> <span class='kw'>=</span> <span class='no'>normalisedlevenshteindists</span>, <span class='kw'>meaningdistfun</span> <span class='kw'>=</span> <span class='no'>hammingdists</span>,
  <span class='no'>...</span>)

<span class='co'># S3 method for list</span>
<span class='fu'>mantel.test</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a formula, distance matrix, or list of distance matrices</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a data frame, distance matrix, or list of matrices of the same length as <code>x</code></p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>logical: immediately produce a plot of the test results</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>extra arguments passed on to the default method</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>correlation coefficient to be computed (default: "pearson")</p></td>
    </tr>
    <tr>
      <th>trials</th>
      <td><p>maximum number of permutations to be tested</p></td>
    </tr>
    <tr>
      <th>shuffle</th>
      <td><p>a function applied to <code>x</code> to shuffle entries, taking a
matrix and an optional permutation specification as its arguments - you
shouldn't normally have to change this</p></td>
    </tr>
    <tr>
      <th>stringdistfun</th>
      <td><p>when <code>x</code> is a formula: edit distance function used
to compute the distance matrix from the specified string column</p></td>
    </tr>
    <tr>
      <th>meaningdistfun</th>
      <td><p>when <code>x</code> is a formula: meaning distance function
used to compute the distance matrix from the specified meaning columns</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a dataframe of class <code><a href='mantel.html'>mantel</a></code> specifying the results of
  the Mantel test(s)</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If the number of possible permutations is reasonably close to
<code>trials</code>, a deterministic enumeration of all the permutations will be
carried out instead of random sampling.</p>
    
    <h2 class="hasAnchor" id="methods-by-class-"><a class="anchor" href="#methods-by-class-"></a>Methods (by class)</h2>

    <ul>
<li><p><code>default</code>: perform Mantel correlation test on two distance
matrices. The distance matrices can either be of type
<code><a href='http://www.rdocumentation.org/packages/stats/topics/dist'>dist</a></code>, plain R matrices or any object that can be
interpreted by <code><a href='check.dist.html'>check.dist</a></code>.</p></li>
<li><p><code>formula</code>: This function can be called with experimental result
data frames, distance matrix calculation is taken care of internally.
<code>x</code> is a formula of the type <code>s ~ m1 + m2 + ...</code> where <code>s</code>
specifies a column of character strings in data frame or matrix <code>y</code>,
while <code>m1</code> etc. are columns specifying the different meaning
dimensions. To calculate the respective distances, the function
<code>stringdistfun</code> is applied to the strings, <code>meaningdistfun</code> to the
meaning columns.</p></li>
<li><p><code>list</code>: when <code>x</code> is a list of distance matrices, and
<code>y</code> is either a single distance matrix or a list of distance matrices
the same length as <code>x</code>. Runs a Mantel test for every pairwise
combination of distance matrices in <code>x</code> and <code>y</code> and returns a
<code><a href='mantel.html'>mantel</a></code> object with as many rows.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='mantel.html'>plot.mantel</a></code>, <code><a href='http://www.rdocumentation.org/packages/stats/topics/cor'>cor</a></code>,
  <code><a href='hammingdists.html'>hammingdists</a></code>, <code><a href='normalisedlevenshteindists.html'>normalisedlevenshteindists</a></code>,
  <code><a href='orderinsensitivedists.html'>orderinsensitivedists</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># small distance matrix, Mantel test run deterministically</span>
<span class='fu'>mantel.test</span>(<span class='fu'>dist</span>(<span class='fl'>1</span>:<span class='fl'>7</span>), <span class='fu'>dist</span>(<span class='fl'>1</span>:<span class='fl'>7</span>))</div><div class='output co'>#&gt; <span class='message'>Permutation space is small, enumerating all 5040 possible permutations.</span></div><img src='mantel.test-3.png' alt='' width='540' height='400' /><div class='output co'>#&gt; Mantel permutation test (method: pearson)
#&gt; r = 1, 1 permutations, mean = 3.03e-18, sd = 0.2255377
#&gt; p (exact) = 0.000595
#&gt; </div><div class='input'>
<span class='co'># smallest distance matrix using random permutations (based on default trials=5000)</span>
<span class='fu'>mantel.test</span>(<span class='fu'>dist</span>(<span class='fl'>1</span>:<span class='fl'>8</span>), <span class='fu'>dist</span>(<span class='fl'>1</span>:<span class='fl'>8</span>))</div><img src='mantel.test-6.png' alt='' width='540' height='400' /><div class='output co'>#&gt; Mantel permutation test (method: pearson)
#&gt; r = 1, 1 permutations, mean = 0.00505, sd = 0.1983759
#&gt; p (empirical) = 4e-04
#&gt; </div><div class='input'><span class='fu'>mantel.test</span>(<span class='no'>word</span> ~ <span class='no'>Var1</span> + <span class='no'>Var2</span>, <span class='fu'>cbind</span>(<span class='kw'>word</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"aa"</span>, <span class='st'>"ab"</span>, <span class='st'>"ba"</span>, <span class='st'>"bb"</span>),
  <span class='fu'><a href='enumerate.meaningcombinations.html'>enumerate.meaningcombinations</a></span>(<span class='fu'>c</span>(<span class='fl'>2</span>, <span class='fl'>2</span>))))</div><div class='output co'>#&gt; <span class='message'>Permutation space is small, enumerating all 24 possible permutations.</span></div><img src='mantel.test-10.png' alt='' width='540' height='400' /><div class='output co'>#&gt; Mantel permutation test (method: pearson)
#&gt; r = 1, 1 permutations, mean = 0, sd = 0.7223151
#&gt; p (exact) = 0.36
#&gt; </div><div class='input'>
<span class='co'># running tests on a list of distance matrices</span>
<span class='fu'>mantel.test</span>(<span class='fu'>list</span>(<span class='fu'>dist</span>(<span class='fl'>1</span>:<span class='fl'>16</span>), <span class='fu'>dist</span>(<span class='fu'>sample</span>(<span class='fl'>16</span>:<span class='fl'>1</span>))),
  <span class='fu'><a href='hammingdists.html'>hammingdists</a></span>(<span class='fu'><a href='enumerate.meaningcombinations.html'>enumerate.meaningcombinations</a></span>(<span class='fu'>c</span>(<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span>))))</div><img src='mantel.test-13.png' alt='' width='540' height='400' /><div class='output co'>#&gt; <span class='warning'>Warning: the condition has length &gt; 1 and only the first element will be used</span></div><div class='output co'>#&gt; Mantel permutation test (method: pearson)
#&gt; r = 0.366, 1 permutations, mean = -0.000317, sd = 0.0838737
#&gt; p (empirical) = 2e-04 (veridical correlation is highest found)
#&gt; </div><div class='output co'>#&gt; <span class='warning'>Warning: the condition has length &gt; 1 and only the first element will be used</span></div><div class='output co'>#&gt; Mantel permutation test (method: pearson)
#&gt; r = -0.0276, 1 permutations, mean = 0.000366, sd = 0.08487016
#&gt; p (empirical) = 0.581
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#methods-by-class-">Methods (by class)</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kevin Stadler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
