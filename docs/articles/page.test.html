<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Page test is not a trend test • cultevo</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">cultevo</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Overview</a>
</li>
<li>
  <a href="../reference/index.html">Function reference</a>
</li>
<li>
  <a href="../articles/page.test.html">Page test tutorial</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kevinstadler/cultevo">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Page test is not a trend test</h1>
                        <h4 class="author">Kevin Stadler</h4>
            
            <h4 class="date">2017-03-30</h4>
          </div>

    
    
<div class="contents">
<div id="definition" class="section level2">
<h2 class="hasAnchor">
<a href="#definition" class="anchor"></a>Definition</h2>
<p>Page’s “test for linear ranks” tests whether there is a linear ordering between <span class="math inline">\(k\)</span> conditions of a between-subjects design with <span class="math inline">\(N\)</span> replications. The predicted ordering of the conditions (or generations) has to be specified a-priori.</p>
<p>Let <span class="math inline">\(m_i\)</span> be the median rank of a score in condition or generation <span class="math inline">\(i\)</span>, then the null hypothesis of the test (which is identical to the one of Friedman’s test) is <span class="math display">\[ m_1 = m_2 = \ldots = m_k \]</span> i.e. there is no difference between the expected ranks for the <span class="math inline">\(k\)</span> conditions. For some reason, <span class="citation">Page (1963)</span>’s original formulation of the <em>alternative</em> hypothesis being tested is given as <span class="math display">\[m_1 &gt; m_2 &gt; \ldots &gt; m_k.\]</span></p>
<p>Later papers and textbook entries correctly point out that the alternative hypothesis considered is actually <span class="math display">\[m_1 \le m_2 \le \ldots \le m_k\]</span> where <em>at least one</em> of the inequalities has to be a true inequality <span class="citation">(Siegel and Castellan 1988; Hollander and Wolfe 1999, 284; Van De Wiel and Di Bucchianico 2001, 143)</span>. <!-- @Sheshkin2004, IX., one that is actually wrong using '<' is @Rayner2000 also: "The scores will be different and will increase as the treatment levels change" - but not ALL are different --></p>
<p>What this means is that even if there is only a single step-wise change in the mean rank, e.g. <span class="math display">\[m_1 &lt; m_2 = \ldots = m_k\]</span> this is sufficient evidence <em>against</em> the null hypothesis.</p>
</div>
<div id="what-the-page-test-is-not" class="section level2">
<h2 class="hasAnchor">
<a href="#what-the-page-test-is-not" class="anchor"></a>What the Page test is not</h2>
<p>The Page test is a ‘trend’ test in the same sense as a linear trend test would be, since it does not test for successive improvement or cumulative increase. It also cannot show whether an increase in the data is significant, since it is a non-parametric test that only considers <em>ranks</em>, not increases, and can merely check for the consistency of rank orderings.</p>
</div>
<div id="mock-dataset-demonstration" class="section level2">
<h2 class="hasAnchor">
<a href="#mock-dataset-demonstration" class="anchor"></a>Mock dataset demonstration</h2>
<p>To test the sensitivity of the test to single step-wise changes we can take a typical sample set of <span class="math inline">\(N=4\)</span> replications with <span class="math inline">\(k=10\)</span> levels each and fix the very first position to always be ranked top (or bottom), with all successive ranks being randomly shuffled, e.g.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pseudorandomranks &lt;-<span class="st"> </span>function(...)
  <span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="kw">list</span>(...), function(p) if (<span class="kw">length</span>(p) &gt;<span class="st"> </span><span class="dv">1</span>) <span class="kw">sample</span>(p) else p))

lowestthenrandom &lt;-<span class="st"> </span>function()
  <span class="kw">pseudorandomranks</span>(<span class="dv">1</span>, <span class="dv">2</span>:<span class="dv">10</span>)

<span class="kw">t</span>(<span class="kw">replicate</span>(<span class="dv">4</span>, <span class="kw">lowestthenrandom</span>()))</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
## [1,]    1    8    4    3    5    7    6   10    2     9
## [2,]    1    9    3    8   10    5    6    4    7     2
## [3,]    1    8   10    4    2    9    7    6    5     3
## [4,]    1    8    9   10    2    6    7    5    4     3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cultevo)

<span class="co"># given a semi-random data generation function, create nrepetitions data sets</span>
<span class="co"># and compute their significance levels according to the Page test</span>
sampleLs &lt;-<span class="st"> </span>function(datafun, nrepetitions) {
  ps &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">"0.001"</span> =<span class="st"> </span><span class="dv">0</span>, <span class="st">"0.01"</span> =<span class="st"> </span><span class="dv">0</span>, <span class="st">"0.05"</span> =<span class="st"> </span><span class="dv">0</span>, <span class="st">"NS"</span> =<span class="st"> </span><span class="dv">0</span>)
  for (i in <span class="kw">seq</span>(nrepetitions)) {
    p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/page.test.html">page.test</a></span>(<span class="kw">datafun</span>(), <span class="dt">verbose=</span><span class="ot">FALSE</span>)$p.value
    if (p &lt;=<span class="st"> </span><span class="fl">0.001</span>) {
      p &lt;-<span class="st"> "0.001"</span>
    } else if (p &lt;=<span class="st"> </span><span class="fl">0.01</span>) {
      p &lt;-<span class="st"> "0.01"</span>
    } else if (p &lt;=<span class="st"> </span><span class="fl">0.05</span>) {
      p &lt;-<span class="st"> "0.05"</span>
    } else {
      p &lt;-<span class="st"> "NS"</span>
    }
    ps[[p]] &lt;-<span class="st"> </span>ps[[p]] +<span class="st"> </span><span class="dv">1</span>
  }
  <span class="kw">unlist</span>(ps) /<span class="st"> </span>nrepetitions
}

sampleps &lt;-<span class="st"> </span>function(testfun, N, datafun, <span class="dt">nrepetitions=</span><span class="dv">1000</span>)
  <span class="kw">testfun</span>(function() <span class="kw">t</span>(<span class="kw">replicate</span>(N, <span class="kw">datafun</span>())), nrepetitions)</code></pre></div>
<p>Generating 1000 datasets like the one above which really only exhibit a single point change in the distribution of median ranks, we get a significant result about half of the time:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sampleps</span>(sampleLs, <span class="dv">4</span>, lowestthenrandom)</code></pre></div>
<pre><code>## 0.001  0.01  0.05    NS 
## 0.032 0.157 0.311 0.500</code></pre>
<p>Increasing the number of replications to 10, still only assuming that the first generation fares worse than all the later ones (which do not exhibit consistent ordering in themselves):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sampleps</span>(sampleLs, <span class="dv">10</span>, lowestthenrandom)</code></pre></div>
<pre><code>## 0.001  0.01  0.05    NS 
## 0.272 0.359 0.259 0.110</code></pre>
<p>The influence is even stronger when the single change point gets closer to the middle of the ordered conditions. When we generate 1000 datasets where the first two ranks are always shuffled in the first two positions, followed by ranks 3-10 also shuffled randomly, we obtain the following distribution of p values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sampleps</span>(sampleLs, <span class="dv">4</span>, function() <span class="kw">pseudorandomranks</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">3</span>:<span class="dv">10</span>))</code></pre></div>
<pre><code>## 0.001  0.01  0.05    NS 
## 0.467 0.384 0.140 0.009</code></pre>
<p>The test is so sensitive to evidence for a change in the suspected direction (even if it is just a single point-wise change) that even evidence for a consistent trend in the opposite direction will not make it change its mind, as can be seen in this data set where more than half of the pairwise differences between ranks indicate downwardness:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># upwards jump from the first three observations to the remaining 7, but the</span>
<span class="co"># remaining 7 exhibit a consistent downwards trend</span>
upwardsjumpdownardstrend &lt;-<span class="st"> </span>function() <span class="kw">pseudorandomranks</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>)
<span class="kw">sampleps</span>(sampleLs, <span class="dv">10</span>, upwardsjumpdownardstrend)</code></pre></div>
<pre><code>## 0.001  0.01  0.05    NS 
##     0     1     0     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">updownup &lt;-<span class="st"> </span>function() <span class="kw">pseudorandomranks</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">6</span>, <span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">7</span>:<span class="dv">8</span>)
<span class="kw">sampleps</span>(sampleLs, <span class="dv">10</span>, updownup)</code></pre></div>
<pre><code>## 0.001  0.01  0.05    NS 
## 0.978 0.022 0.000 0.000</code></pre>
</div>
<div id="alternatives-to-the-page-test" class="section level2">
<h2 class="hasAnchor">
<a href="#alternatives-to-the-page-test" class="anchor"></a>Alternatives to the Page test</h2>
<p>The seasonal Kendall test <span class="citation">(Hirsch, Slack, and Smith 1982; Gilbert 1987; Gibbons, Bhaumik, and Aryal 2009)</span> takes seasonal effects on environmental measurements into account by computing the Mann Kendall test on each of <span class="math inline">\(k\)</span> seasons/months separately, and then combining the individual test results. Since the order of the individual seasons is not actually taken into account (it only is in a later version of the test, <span class="citation">Hirsch and Slack (1984)</span>), the test is essentially a within-subject version that combines the results of <span class="math inline">\(k\)</span> independent Mann-Kendall tests into one to increase the statistical power <span class="citation">(Gibbons, Bhaumik, and Aryal 2009, 211)</span>. The test was in fact already transferred to test for trends in different geographic sample locations rather than seasons (see <span class="citation">Helsel and Frans (2006)</span>). The seasonal’s test alternative hypothesis is “a monotone trend in one or more seasons” <span class="citation">(Hirsch and Slack 1984, 728)</span>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Gibbons2009">
<p>Gibbons, Robert D, Dulal Bhaumik, and Subhash Aryal. 2009. <em>Statistical Methods for Groundwater Monitoring</em>. 2nd ed.</p>
</div>
<div id="ref-Gilbert1987">
<p>Gilbert, Richard. 1987. <em>Statistical Methods for Environmental Pollution Monitoring</em>. John Wiley &amp; Sons, Inc.</p>
</div>
<div id="ref-Helsel2006">
<p>Helsel, Dennis R, and Lonna M Frans. 2006. “Regional Kendall test for trend.” <em>Environmental Science and Technology</em> 40 (13): 4066–73. doi:<a href="https://doi.org/10.1021/es051650b">10.1021/es051650b</a>.</p>
</div>
<div id="ref-Hirsch1984">
<p>Hirsch, Robert M, and James R Slack. 1984. “A Nonparametric Trend Test for Seasonal Data With Serial Dependence.” <em>Water Resources Research</em> 20 (6): 727–32. doi:<a href="https://doi.org/10.1029/WR020i006p00727">10.1029/WR020i006p00727</a>.</p>
</div>
<div id="ref-Hirsch1982">
<p>Hirsch, Robert M, James R Slack, and Richard A Smith. 1982. “Techniques of trend analysis for monthly water quality data.” <em>Water Resources Research</em> 18 (1): 107–21. doi:<a href="https://doi.org/10.1029/WR018i001p00107">10.1029/WR018i001p00107</a>.</p>
</div>
<div id="ref-Hollander1999">
<p>Hollander, Miles, and Douglas A Wolfe. 1999. <em>Nonparametric Statistical Methods</em>.</p>
</div>
<div id="ref-Page1963">
<p>Page, Ellis Batten. 1963. “Ordered hypotheses for multiple treatments: a significance test for linear ranks.” <em>Journal of the American Statistical Association</em> 58: 216–30. doi:<a href="https://doi.org/10.1080/01621459.1963.10500843">10.1080/01621459.1963.10500843</a>.</p>
</div>
<div id="ref-Siegel1988">
<p>Siegel, Sidney, and N. John Castellan. 1988. <em>Nonparametric Statistics for the Behavioral Sciences</em>. McGraw-Hill.</p>
</div>
<div id="ref-VanDeWiel2001">
<p>Van De Wiel, Mark A., and A. Di Bucchianico. 2001. “Fast computation of the exact null distribution of Spearman’s rho and Page’s L statistic for samples with and without ties.” <em>Journal of Statistical Planning and Inference</em> 92: 133–45. doi:<a href="https://doi.org/10.1016/S0378-3758(00)00166-X">10.1016/S0378-3758(00)00166-X</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#definition">Definition</a></li>
      <li><a href="#what-the-page-test-is-not">What the Page test is not</a></li>
      <li><a href="#mock-dataset-demonstration">Mock dataset demonstration</a></li>
      <li><a href="#alternatives-to-the-page-test">Alternatives to the Page test</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Kevin Stadler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
